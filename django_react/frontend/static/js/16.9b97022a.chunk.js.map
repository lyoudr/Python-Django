{"version":3,"sources":["content/piano-game/PianoGame.js"],"names":["EachKeyBoard","props","state","datakey","datanote","keyboardkey","class","fired","handleMouseDown","bind","handleMouseUp","event","startTime","timeStamp","this","type","endTime","className","data-key","data-note","onMouseDown","onMouseUp","React","Component","Audio","src","RateArea","rateValue","setState","target","value","id","onChange","updaterateValue","placeholder","onClick","handleMusicRate","KeyBoard","keyboardarray","eventType","setCounter","document","querySelector","play","timelapse","printNote","Eachindex","key","Audioindex","map","eachitem","index","renderSquare","renderAudio","PianoGame","rate","executed","sheetnumber","note_data","Measure","keydown","keyup","window","addEventListener","keyCode","keyboarddatakey","getAttribute","setTimeout","VF","Vex","Flow","div","getElementById","renderer","Renderer","Backends","SVG","resize","context","getContext","setFont","setBackgroundFillStyle","stave","Stave","addClef","addTimeSignature","setContext","draw","formatter","Formatter","voice","Voice","num_beats","beat_value","addTickables","joinVoices","formatToStave","beat1","beat3","beat2","beat4","beat8","beat16","SetNote","duration","accidentalvalue","match","dvalue","prevState","StaveNote","clef","keys","addAccidental","Accidental","addDotToAll","removeEventListener"],"mappings":"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","file":"static/js/16.9b97022a.chunk.js","sourcesContent":["import React from 'react';\nimport '../../assets/sass/pianogame/PianoGame.scss';\nimport Vex from 'vexflow';\n\n//Each keyboard\nclass EachKeyBoard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      datakey: props.datakey,\n      datanote: props.datanote,\n      keyboardkey: props.keyboardkey,\n      class: props.class,\n      fired: false\n    }\n    //This binding is necessary to make `this` work in the callbalck;\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handleMouseUp = this.handleMouseUp.bind(this);\n  }\n  handleMouseDown(datakey, event) {\n    let startTime = event.timeStamp;\n    this.props.handleMouseDown(datakey, event.type, startTime);\n  }\n  handleMouseUp(datakey, event) {\n    let endTime = event.timeStamp;\n    this.props.handleMouseUp(datakey, event.type, endTime);\n  }\n  render() {\n    return (\n      <div className={this.state.class}\n        data-key={this.state.datakey}\n        data-note={this.state.datanote}\n        onMouseDown={this.handleMouseDown.bind(this, this.state.datakey)}\n        onMouseUp={this.handleMouseUp.bind(this, this.state.datakey)}\n      >\n        <span className=\"hints\">{this.state.keyboardkey}</span>\n      </div>\n    )\n  }\n}\n\n//Each Audio\nclass Audio extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      datakey: props.datakey,\n      src: props.src,\n      keyboardkey: props.keyboardkey\n    }\n  }\n  render() {\n    return (\n      <audio data-key={this.state.datakey} keyboardkey={this.state.keyboardkey} src={this.state.src} />\n    )\n  }\n}\n\n//Rate Area \nclass RateArea extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      rateValue: 60,\n    }\n  }\n  updaterateValue(event) {\n    this.setState({\n      rateValue: event.target.value\n    })\n  }\n  render() {\n    return (\n      <header className=\"col-12 col-s-12\">\n        <p className=\"title\">Use your keyboard.</p> \n        <p className=\"title\">Hover for hints.</p>\n        <p className=\"title\">Show Piano</p>\n        <div id=\"MusicRateArea\" className=\"musicrate_area\">\n          <p className=\"music_rate\"> Music Rate</p>\n          <input value={this.state.rateValue} onChange={this.updaterateValue.bind(this)} type=\"text\" placeholder=\"60 ~ 190\" />\n          <button className=\"rate_btn\" onClick={() => { this.props.handleMusicRate(this.state.rateValue) }}>Enter</button>\n        </div>\n      </header>\n    )\n  }\n}\n\n//KeyBoard\nclass KeyBoard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      keyboardarray: [\n        { datakey: \"c/4\", datanote: \"C\", keyboardkey: \"A\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/040.wav\", className: 'key' },\n        { datakey: \"c#/4\", datanote: \"C#\", keyboardkey: \"W\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/041.wav\", className: 'key sharp' },\n        { datakey: \"d/4\", datanote: \"D\", keyboardkey: \"S\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/042.wav\", className: 'key' },\n        { datakey: \"d#/4\", datanote: \"D#\", keyboardkey: \"E\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/043.wav\", className: 'key sharp' },\n        { datakey: \"e/4\", datanote: \"E\", keyboardkey: \"D\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/044.wav\", className: 'key' },\n        { datakey: \"f/4\", datanote: \"F\", keyboardkey: \"F\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/045.wav\", className: 'key' },\n        { datakey: \"f#/4\", datanote: \"F#\", keyboardkey: \"T\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/046.wav\", className: 'key sharp' },\n        { datakey: \"g/4\", datanote: \"G\", keyboardkey: \"G\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/047.wav\", className: 'key' },\n        { datakey: \"g#/4\", datanote: \"G#\", keyboardkey: \"Y\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/048.wav\", className: 'key sharp' },\n        { datakey: \"a/4\", datanote: \"A\", keyboardkey: \"H\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/049.wav\", className: 'key' },\n        { datakey: \"a#/4\", datanote: \"A#\", keyboardkey: \"U\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/050.wav\", className: 'key sharp' },\n        { datakey: \"b/4\", datanote: \"B\", keyboardkey: \"J\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/051.wav\", className: 'key' },\n        { datakey: \"c/5\", datanote: \"C\", keyboardkey: \"K\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/052.wav\", className: 'key' },\n        { datakey: \"c#/5\", datanote: \"C#\", keyboardkey: \"O\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/053.wav\", className: 'key sharp' },\n        { datakey: \"d/5\", datanote: \"D\", keyboardkey: \"L\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/054.wav\", className: 'key' },\n        { datakey: \"d#/5\", datanote: \"D#\", keyboardkey: \"P\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/055.wav\", className: 'key sharp' },\n        { datakey: \"e/5\", datanote: \"E\", keyboardkey: \";\", src: \"http://carolinegabriel.com/demo/js-keyboard/sounds/056.wav\", className: 'key' },\n      ],\n      startTime: null,\n      datakey: null\n    }\n  }\n  handleMouseDown(datakey, eventType, startTime) {\n    this.props.setCounter(0);\n    this.setState({ startTime: startTime });\n    if (eventType === 'mousedown') {\n      let selectedKey = document.querySelector(`audio[data-key= \"${datakey}\" ]`);\n      selectedKey.play();\n    }\n  }\n  handleMouseUp(datakey, eventType, endTime) {\n    let EachendTime = endTime;\n    let timelapse = ((EachendTime - this.state.startTime) / 1000);\n    if (eventType === 'mouseup') {\n      this.props.printNote(timelapse, datakey);\n    }\n  }\n\n  renderSquare(datakey, datanote, keyboardkey, Eachindex, className) {\n    return (\n      <EachKeyBoard\n        class={className}\n        key={Eachindex}\n        datakey={datakey}\n        datanote={datanote}\n        keyboardkey={keyboardkey}\n        handleMouseDown={(datakey, eventType, startTime) => { this.handleMouseDown(datakey, eventType, startTime) }}\n        handleMouseUp={(datakey, eventType, endTime) => { this.handleMouseUp(datakey, eventType, endTime) }}\n      />\n    )\n  }\n  renderAudio(datakey, src, keyboardkey, Audioindex) {\n    return (\n      <Audio\n        key={Audioindex}\n        datakey={datakey}\n        keyboardkey={keyboardkey}\n        src={src}\n      />\n    )\n  }\n  render() {\n    return (\n      <div id=\"main\" className=\"col-12 col-s-12\">\n        <div className=\"keys\">\n          {this.state.keyboardarray.map((eachitem, index) => {\n            return this.renderSquare(\n              eachitem.datakey,\n              eachitem.datanote,\n              eachitem.keyboardkey,\n              `EachKey${index}`,\n              eachitem.className\n            );\n          })}\n        </div>\n        <div>\n          {this.state.keyboardarray.map((eachitem, index) => {\n            return this.renderAudio(\n              eachitem.datakey,\n              eachitem.src,\n              eachitem.keyboardkey,\n              `Audio${index}`,\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n}\n\n//Top Area\nclass PianoGame extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      rate: 60,\n      executed: false,\n      sheetnumber: 1,\n      note_data: [],\n      Measure: 0,\n      startTime: null,\n      fired: false // Just trigger one keydown event by adding fired flag:\n    }\n    this.keydown = this.keydown.bind(this);\n    this.keyup = this.keyup.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.keydown);\n    window.addEventListener('keyup', this.keyup);\n  }\n  keydown(event) {\n    if (event.keyCode == 65 || event.keyCode == 87 || event.keyCode == 83 || event.keyCode == 69 || event.keyCode == 68 || event.keyCode == 70 || event.keyCode == 84 || event.keyCode == 71 || event.keyCode == 89 || event.keyCode == 72 || event.keyCode == 85 || event.keyCode == 74 || event.keyCode == 75 || event.keyCode == 79 || event.keyCode == 76 || event.keyCode == 80 || event.keyCode == 186) {\n      if (!this.state.fired) {\n        //在第一次按壓鍵盤後，將 flag 設為 true;\n        this.setState({ fired: true });\n        this.setCounter(0);\n        this.setState({ startTime: event.timeStamp });\n        let selectedKey = document.querySelector(`audio[keyboardkey= \"${event.key}\" ]`);\n        selectedKey.play();\n      }\n    } else {\n      return;\n    }\n  }\n  keyup(event) {\n    if (event.keyCode == 65 || event.keyCode == 87 || event.keyCode == 83 || event.keyCode == 69 || event.keyCode == 68 || event.keyCode == 70 || event.keyCode == 84 || event.keyCode == 71 || event.keyCode == 89 || event.keyCode == 72 || event.keyCode == 85 || event.keyCode == 74 || event.keyCode == 75 || event.keyCode == 79 || event.keyCode == 76 || event.keyCode == 80 || event.keyCode == 186) {\n      let EachendTime = event.timeStamp;\n      let timelapse = ((EachendTime - this.state.startTime) / 1000);\n      let keyboarddatakey = document.querySelector(`audio[keyboardkey= \"${event.key}\" ]`).getAttribute('data-key');\n      this.printNote(timelapse, keyboarddatakey);\n    } else {\n      return;\n    }\n  }\n  handleMusicRate(rate) {\n    this.setState({ rate: rate })\n  }\n\n  setCounter(timelapse) {\n    if (this.state.executed === true) {\n      return\n    } else if (this.state.executed === false && timelapse === 0) {\n      //Set Measure\n      this.setState({ executed: true });\n      //計算每個小節所佔的總秒數\n      let Measure = ((60 / this.state.rate) * 4 * 1000) + 1000;\n      //當時間經過一個小節，小節數會 + 1\n      let Timer = () => {\n        //Create an SVG renderer and attach it to the DIV element named \"sheet\"\n        let VF = Vex.Flow;\n        let div = document.getElementById('sheet');\n        let renderer = new VF.Renderer(div, VF.Renderer.Backends.SVG);\n        // Configure the rendering context.\n        renderer.resize(500, 500);\n        var context = renderer.getContext();\n        context.setFont(\"Arial\", 10, \"\").setBackgroundFillStyle(\"#eed\");\n        // Create a stave of width 400 at position 10, 40 on the canvas.\n        var stave = new VF.Stave(10, 20, 300);\n        // Add a clef and time signature.\n        stave.addClef(\"treble\").addTimeSignature(\"4/4\");\n        // Connect it to the rendering context and draw!\n        stave.setContext(context).draw();\n        // 抓取此小節存的樂譜\n        let note_data = this.state.note_data;\n        var formatter = new Vex.Flow.Formatter();\n        var voice = new VF.Voice({ num_beats: 4, beat_value: 4 }).addTickables(note_data);\n        formatter.joinVoices([voice]).formatToStave([voice], stave);\n        voice.draw(context, stave);\n        //Initialize this.state.note_data\n        this.setState({ note_data: [] });\n      }\n      setTimeout(Timer, Measure);\n    }\n  }\n\n  printNote(timelapse, datakey) {\n    let VF = Vex.Flow;\n    //Rate \n    //設定節拍\n    let beat1 = (60 / this.state.rate) * 4; \n    let beat3 = (60 / this.state.rate) * 3;\n    let beat2 = (60 / this.state.rate) * 2;\n    let beat4 = (60 / this.state.rate);\n    let beat8 = (60 / this.state.rate / 2);\n    let beat16 = (60 / this.state.rate / 4);\n    //將音高和音符輸出給 note_data 儲存\n    let SetNote = (datakey, duration) => {\n      //1. datakey 是否含有 # 或是 b\n      let accidentalvalue = datakey.match(/#/i) || datakey.match(/b/i);\n      //2. duration 是否有 d\n      let dvalue = duration.match(/d/i);\n      if (dvalue === null) {\n        if (accidentalvalue) {\n          if (accidentalvalue[0] === \"#\") {\n            this.setState(prevState => ({\n              note_data: [...prevState.note_data, new VF.StaveNote({ clef: \"treble\", keys: [`${datakey}`], duration: duration })\n                .addAccidental(0, new VF.Accidental(\"#\"))]\n            }));\n          } else if (accidentalvalue[0] === \"b\") {\n            this.setState(prevState => ({\n              note_data: [...prevState.note_data, new VF.StaveNote({ clef: \"treble\", keys: [`${datakey}`], duration: duration }).\n                addAccidental(0, new VF.Accidental(\"b\"))\n              ]\n            }));\n          }\n        } else {\n          this.setState(prevState => ({\n            note_data: [...prevState.note_data, new VF.StaveNote({ clef: \"treble\", keys: [`${datakey}`], duration: duration })\n            ]\n          }));\n        }\n      } else if (dvalue) {\n        //如果是含有點的節拍，需要加上點\n        if (accidentalvalue) {\n          if (accidentalvalue === \"#\") {\n            this.setState(prevState => ({\n              note_data: [...prevState.note_data, new VF.StaveNote({ clef: \"treble\", keys: [`${datakey}`], duration: duration }).\n                addAccidental(0, new VF.Accidental(\"#\")).addDotToAll()\n              ]\n            }));\n          } else if (accidentalvalue === \"b\") {\n            this.setState(prevState => ({\n              note_data: [...prevState.note_data, new VF.StaveNote({ clef: \"treble\", keys: [`${datakey}`], duration: duration }).\n                addAccidental(0, new VF.Accidental(\"b\")).addDotToAll()\n              ]\n            }));\n          }\n        } else {\n          this.setState(prevState => ({\n            note_data: [...prevState.note_data, new VF.StaveNote({ clef: \"treble\", keys: [`${datakey}`], duration: duration }).\n              addDotToAll()\n            ]\n          }));\n        }\n      }\n    }\n\n    //判斷音符長度\n    if (timelapse === beat1 || timelapse > beat1) {\n      //4 拍，全音符\n      SetNote(datakey, \"w\");\n    } else if (timelapse >= beat3) {\n      //3 拍，3分音符\n      SetNote(datakey, \"2d\");\n    } else if (timelapse >= beat2) {\n      //2 拍，2分音符\n      SetNote(datakey, \"2\");\n    } else if (timelapse > beat4 && timelapse < beat2) {\n      //1 拍半，4分音符逗點\n      SetNote(datakey, \"qd\");\n    } else if (timelapse === beat4) {\n      //1 拍，4分音符\n      SetNote(datakey, \"q\");\n    } else if (timelapse > beat8 && timelapse < beat4) {\n      //3/4 拍，8分音符逗點\n      SetNote(datakey, \"8d\");\n    } else if (timelapse === beat8) {\n      //半拍，8分音符\n      SetNote(datakey, \"8\");\n    } else if (timelapse < beat8 && timelapse > beat16) {\n      //3/8 拍，16分音符逗點\n      SetNote(datakey, \"16d\");\n    } else if (timelapse === beat16) {\n      //1/4 拍，16 分音符\n      SetNote(datakey, \"16\");\n    } else if (timelapse < beat16) {\n      //1/8 拍，32 分音符\n      SetNote(datakey, \"32\");\n    }\n\n\n  }\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.keydown);\n    window.removeEventListener('keyup', this.keyup);\n  }\n  render() {\n    return (\n      <div className=\"pianogame main\">\n        <RateArea\n          handleMusicRate={(rate) => this.handleMusicRate(rate)}\n        />\n        <div className=\"col-12 col-s-12 nowplaying\"></div>\n        <KeyBoard\n          setCounter={(timelapse) => this.setCounter(timelapse)}\n          printNote={(timelapse, datakey) => this.printNote(timelapse, datakey)}\n        />\n        <div id=\"sheet\" className=\"col-12 col-s-12 sheet\">\n          <div id=\"sheet1\"></div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default PianoGame"],"sourceRoot":""}