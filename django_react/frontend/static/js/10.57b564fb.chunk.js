(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[10],{224:function(e,t,a){e.exports=a.p+"static/media/restaurant.d9af8db5.svg"},225:function(e,t,a){},242:function(e,t,a){e.exports=a.p+"static/media/menu.c7ee1e62.svg"},243:function(e,t,a){e.exports=a.p+"static/media/price.9c83ac6a.svg"},244:function(e,t,a){e.exports=a.p+"static/media/rating.11a01e16.svg"},245:function(e,t,a){e.exports=a.p+"static/media/distance.27661887.svg"},246:function(e,t,a){},257:function(e,t,a){"use strict";a.r(t);var n=a(7),s=a(8),o=a(12),r=a(9),i=a(10),c=a(0),l=a.n(c),u=a(226),p=a(224),m=a.n(p),h=(a(225),function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).mapRef=l.a.createRef(),s.state={currentLocation:{lat:null,lng:null},storemarkers:[],selectedPlace:{},activeMarker:{},showingInfoWindow:!1},s.centerMoved=s.centerMoved.bind(Object(o.a)(s)),s.loadMapCenter=s.loadMapCenter.bind(Object(o.a)(s)),s.nearbySearch=s.nearbySearch.bind(Object(o.a)(s)),s.onSelectedRes=s.onSelectedRes.bind(Object(o.a)(s)),s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadMapCenter()}},{key:"componentDidUpdate",value:function(e){var t=this.props.selectedRes;t&&e.selectedRes!==this.props.selectedRes&&this.onSelectedRes(t.name,t.geometry.location.lat(),t.geometry.location.lng())}},{key:"loadMapCenter",value:function(){var e=this;navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){var a=t.coords,n=Object.assign({},e.state.currentLocation,{currentLocation:{lat:a.latitude,lng:a.longitude}});e.setState({currentLocation:n},(function(){return e.nearbySearch()}))}))}},{key:"nearbySearch",value:function(){var e=this,t=[],a=new this.props.google.maps.LatLng(this.state.currentLocation.lat,this.state.currentLocation.lng),n=new this.props.google.maps.Map(this.mapRef.current,{center:a,zoom:15}),s={location:a,radius:"500",type:["restaurant"]};new this.props.google.maps.places.PlacesService(n).nearbySearch(s,(function(a,n){if(n===e.props.google.maps.places.PlacesServiceStatus.OK){for(var s=0;s<a.length;s++)t.push(a[s]);e.setState({storemarkers:t})}e.props.setCenter(e.state.currentLocation),e.props.setRestaurant(e.state.storemarkers)}))}},{key:"centerMoved",value:function(e,t){var a=this;this.setState({currentLocation:{lat:t.center.lat(),lng:t.center.lng()}},(function(){return a.nearbySearch()}))}},{key:"onSelectedRes",value:function(e,t,a){this.setState({currentLocation:{lat:t,lng:a}});var n=this.state.storemarkers.map((function(t){return t.isChoosed=!1,t.name===e?(t.isChoosed=!0,t):t}));this.props.setRestaurant(n)}},{key:"onMarkerClick",value:function(e,t){this.setState({selectedPlace:e,activeMarker:t,showingInfoWindow:!0})}},{key:"render",value:function(){var e=this;return l.a.createElement(u.Map,{ref:this.mapRef,google:this.props.google,center:{lat:this.state.currentLocation.lat,lng:this.state.currentLocation.lng},zoom:15,style:{height:"100vh"},onDragend:function(t,a){return e.centerMoved(t,a)}},l.a.createElement(u.Marker,{title:"Your location",position:{lat:this.state.currentLocation.lat,lng:this.state.currentLocation.lng}}),l.a.createElement(u.InfoWindow,{marker:this.state.activeMarker,visible:this.state.showingInfoWindow},l.a.createElement("div",null,l.a.createElement("p",null,this.state.selectedPlace.title))),this.state.storemarkers.map((function(t,a){return l.a.createElement(u.Marker,{key:t,title:t.name,position:t.geometry.location,onClick:function(t,a){e.onSelectedRes(t.title,a.position.lat(),a.position.lng()),e.onMarkerClick(t,a)},icon:{url:"".concat(m.a),anchor:new e.props.google.maps.Point(32,32),scaledSize:new e.props.google.maps.Size(12,12)}})})))}}]),a}(l.a.Component)),d=Object(u.GoogleApiWrapper)({apiKey:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_HOSTURL:"http://ec2-13-231-184-72.ap-northeast-1.compute.amazonaws.com:3000/api",REACT_APP_WEBSOCKET:"ws://ec2-13-231-184-72.ap-northeast-1.compute.amazonaws.com:4600/chatroom"}).REACT_APP_APIKEY),libraries:["places"]})(h),g=a(242),v=a.n(g),f=a(243),S=a.n(f),y=a(244),k=a.n(y),R=a(245),b=a.n(R),w=(a(246),function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).state={restaurant_lists:[],rankResType:[{className:"price",type:"price_level",img:S.a},{className:"rating",type:"rating",img:k.a},{className:"distance",type:"distance",img:b.a}],selectedRes:null,currentLocation:{lat:null,lng:null},isOpenSide:!1,isShowBar:"show",isShowMenu:"hide"},s.setRestaurant=s.setRestaurant.bind(Object(o.a)(s)),s.setCenter=s.setCenter.bind(Object(o.a)(s)),s.showMenu=s.showMenu.bind(Object(o.a)(s)),s.chooseRestaurant=s.chooseRestaurant.bind(Object(o.a)(s)),s}return Object(s.a)(a,[{key:"showMenu",value:function(){var e=this;this.setState({isOpenSide:!this.state.isOpenSide},(function(){e.setState({isShowBar:e.state.isOpenSide?"hide":"show",isShowMenu:e.state.isOpenSide?"show":"hide"})}))}},{key:"rankRestaurant",value:function(e){var t=this;!function(e,a){if("price_level"===a||"rating"===a)e.sort((function(e,t){return e[a]>t[a]?1:e[a]<t[a]?-1:0}));else if("distance"===a){var n=t.state.currentLocation.lat,s=t.state.currentLocation.lng;e.sort((function(e,t){var a=Math.sqrt(Math.pow(e.geometry.location.lat()-n,2)+Math.pow(e.geometry.location.lng()-s,2)),o=Math.sqrt(Math.pow(t.geometry.location.lat()-n,2)+Math.pow(t.geometry.location.lng()-s,2));return a>o?1:a<o?-1:0}))}t.setState({restaurant_lists:e})}(this.state.restaurant_lists,e)}},{key:"setCenter",value:function(e){this.setState({currentLocation:e})}},{key:"setRestaurant",value:function(e){this.setState({restaurant_lists:e}),document.getElementById("choosedRes")&&document.getElementById("choosedRes").scrollIntoView()}},{key:"chooseRestaurant",value:function(e){this.setState({selectedRes:e})}},{key:"render",value:function(){var e=this;return l.a.createElement("main",{className:"restaurant"},l.a.createElement("div",{className:"menu ".concat(this.state.isShowBar),onClick:this.showMenu},l.a.createElement("img",{src:v.a,alt:"img"})),l.a.createElement("div",{className:"select ".concat(this.state.isShowMenu)},this.state.rankResType.map((function(t,a){return l.a.createElement("div",{key:t,className:t.className,onClick:e.rankRestaurant.bind(e,"".concat(t.type))},l.a.createElement("img",{src:t.img,alt:"img"}))}))),l.a.createElement("div",{className:"container custom"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-4 col-12 restaurant_info"},this.state.restaurant_lists.map((function(t,a){return l.a.createElement("div",{key:t,onClick:e.chooseRestaurant.bind(e,t),id:t.isChoosed?"choosedRes":null,className:t.isChoosed?"active":""},l.a.createElement("p",{className:"name"},a+1,". ",t.name),l.a.createElement("p",{className:"vicinity"},t.vicinity),l.a.createElement("div",{className:"price_rating"},l.a.createElement("p",{className:"price"},t.price_level,"$"),l.a.createElement("p",{className:"rating"},"Rating: ",t.rating)))}))),l.a.createElement("div",{className:"col-md-8 col-12 googlemap"},l.a.createElement(d,{setRestaurant:this.setRestaurant,setCenter:this.setCenter,selectedRes:this.state.selectedRes})))))}}]),a}(l.a.Component));t.default=w}}]);
//# sourceMappingURL=10.57b564fb.chunk.js.map